"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1864],{50395:(e,t,r)=>{r.d(t,{A:()=>l,AuthProvider:()=>c});var a=r(95155),i=r(12115),n=r(16203),o=r(35317),s=r(98915);let d=(0,i.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,i.useState)(null),[l,u]=(0,i.useState)(!0),[g,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{if(!s.j2){console.error("Firebase auth is not initialized"),u(!1);return}let e=(0,n.hg)(s.j2,async e=>{try{if(e){if(!s.db){console.error("Firebase db is not initialized"),u(!1);return}let t=await (0,o.x7)((0,o.H9)(s.db,"users",e.uid));if(t.exists()){let r=t.data();c({uid:e.uid,email:e.email,displayName:e.displayName,isVerified:e.emailVerified,role:r.role||"user",createdAt:r.createdAt?new Date(r.createdAt.toDate()):null,updatedAt:r.updatedAt?new Date(r.updatedAt.toDate()):null,walletAddress:r.walletAddress,campaignsCreated:r.campaignsCreated,donationsCount:r.donationsCount,totalDonated:r.totalDonated,totalRaised:r.totalRaised})}else{let t={uid:e.uid,email:e.email,displayName:e.displayName,isVerified:e.emailVerified,role:"user",createdAt:new Date,updatedAt:new Date};await (0,o.BN)((0,o.H9)(s.db,"users",e.uid),t),c(t)}}else c(null)}catch(e){console.error("Error in auth state change:",e),p("Failed to load user data"),c(null)}finally{u(!1)}});return()=>e()},[]);let m=async(e,t,r)=>{if(!s.j2||!s.db)throw Error("Firebase is not initialized");try{u(!0),p(null);let a=await (0,n.eJ)(s.j2,e,t);await (0,n.r7)(a.user,{displayName:r}),await (0,o.BN)((0,o.H9)(s.db,"users",a.user.uid),{uid:a.user.uid,email:e,displayName:r,isVerified:!1,role:"user",createdAt:new Date,updatedAt:new Date}),await (0,n.gA)(a.user)}catch(e){throw console.error("Sign up error:",e),p(e.message),e}finally{u(!1)}},f=async(e,t)=>{if(!s.j2)throw Error("Firebase auth is not initialized");try{u(!0),p(null),await (0,n.x9)(s.j2,e,t)}catch(e){throw console.error("Sign in error:",e),p(e.message),e}finally{u(!1)}},h=async()=>{if(!s.j2)throw Error("Firebase auth is not initialized");try{u(!0),p(null),await (0,n.CI)(s.j2)}catch(e){throw console.error("Sign out error:",e),p(e.message),e}finally{u(!1)}},y=async()=>{if(!s.j2||!s.j2.currentUser)throw Error("No user is currently signed in");try{await (0,n.gA)(s.j2.currentUser)}catch(e){throw console.error("Email verification error:",e),e}},w=async e=>{if(!s.j2)throw Error("Firebase auth is not initialized");try{await (0,n.J1)(s.j2,e)}catch(e){throw console.error("Password reset error:",e),e}},b=async e=>{if(!s.j2||!s.j2.currentUser||!s.db)throw Error("Firebase is not initialized or no user is signed in");try{await (0,n.r7)(s.j2.currentUser,{displayName:e}),await (0,o.mZ)((0,o.H9)(s.db,"users",s.j2.currentUser.uid),{displayName:e,updatedAt:new Date}),r&&c({...r,displayName:e})}catch(e){throw console.error("Profile update error:",e),e}};return(0,a.jsx)(d.Provider,{value:{user:r,loading:l,error:g,signUp:m,signIn:f,signOut:h,sendEmailVerification:y,sendPasswordReset:w,updateUserProfile:b},children:t})}function l(){let e=(0,i.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},53999:(e,t,r)=>{r.d(t,{cn:()=>n});var a=r(52596),i=r(39688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.$)(t))}},75586:(e,t,r)=>{r.d(t,{xi:()=>i});var a=r(35317);function i(e){try{if(e instanceof Date&&!isNaN(e.getTime()))return e;if(e instanceof a.Dc)return e.toDate();if("string"==typeof e||"number"==typeof e){let t=new Date(e);if(!isNaN(t.getTime()))return t}if(e&&"object"==typeof e&&"seconds"in e)return new Date(1e3*e.seconds);return console.warn("Invalid date value, using current date as fallback:",e),new Date}catch(e){return console.error("Error converting date:",e),new Date}}},88482:(e,t,r)=>{r.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>d,Zp:()=>o,aR:()=>s,wL:()=>u});var a=r(95155),i=r(12115),n=r(53999);let o=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...i})});o.displayName="Card";let s=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...i})});s.displayName="CardHeader";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...i})});d.displayName="CardTitle";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...i})});c.displayName="CardDescription";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...i})});l.displayName="CardContent";let u=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...i})});u.displayName="CardFooter"},92872:(e,t,r)=>{r.d(t,{O:()=>d});var a=r(35317),i=r(98915),n=r(75586);let o=[{id:"mock-campaign-1",title:"Help Fund Medical Research",description:"This campaign aims to fund important medical research for rare diseases.",goal:1e4,raised:3500,donors:42,daysLeft:15,image:"/placeholder.svg?height=400&width=600",category:"Medical",status:"active",creatorId:"mock-user",walletAddress:"rHb9CJAWyB4rj91VRWn96DkukG4bwdtyTh",createdAt:new Date,updatedAt:new Date,endDate:new Date(Date.now()+1296e6)},{id:"mock-campaign-2",title:"Community Garden Project",description:"Help us build a community garden in the heart of the city.",goal:5e3,raised:2200,donors:28,daysLeft:20,image:"/placeholder.svg?height=400&width=600",category:"Community",status:"active",creatorId:"mock-user",walletAddress:"rHb9CJAWyB4rj91VRWn96DkukG4bwdtyTh",createdAt:new Date,updatedAt:new Date,endDate:new Date(Date.now()+1728e6)}],s=e=>{try{let t=JSON.parse(localStorage.getItem("pendingDonations")||"[]");return t.push({...e,timestamp:new Date().toISOString(),status:"pending"}),localStorage.setItem("pendingDonations",JSON.stringify(t)),console.log("Donation stored in localStorage for later processing"),!0}catch(e){return console.error("Failed to store in localStorage:",e),!1}};class d{static async createCampaign(e){try{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[t,r]=e;return void 0!==r}));return(await (0,a.gS)((0,a.collection)(i.db,"campaigns"),{...t,createdAt:new Date,updatedAt:new Date})).id}catch(e){return console.error("Create campaign error:",e),"mock-".concat(Math.random().toString(36).substring(2,15))}}static async getCampaigns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{let t=(0,a.query)((0,a.collection)(i.db,"campaigns"),(0,a.orderBy)("createdAt","desc"),(0,a.AB)(e)),r=await (0,a.getDocs)(t);if(r.empty)return o;return r.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:(0,n.xi)(t.createdAt),updatedAt:(0,n.xi)(t.updatedAt),endDate:(0,n.xi)(t.endDate)}}).filter(e=>"active"===e.status)}catch(e){return console.error("Get campaigns error:",e),o}}static async getCampaignById(e){try{let t=(0,a.H9)(i.db,"campaigns",e),r=await (0,a.x7)(t);if(!r.exists())return o[0];let s=r.data();return{id:r.id,...s,createdAt:(0,n.xi)(s.createdAt),updatedAt:(0,n.xi)(s.updatedAt),endDate:(0,n.xi)(s.endDate)}}catch(e){return console.error("Get campaign error:",e),o[0]}}static async updateCampaign(e,t){try{console.log("Attempting to update campaign:",e,t),await (0,a.mZ)((0,a.H9)(i.db,"campaigns",e),{...t,updatedAt:new Date}),console.log("Campaign updated successfully")}catch(t){if(console.error("Update campaign error details:",{error:t.message,code:t.code,campaignId:e}),"permission-denied"===t.code)throw Error("You don't have permission to update this campaign. Please check if you're the campaign owner and logged in.");if("not-found"===t.code)throw Error("Campaign not found.");if(t.message.includes("Missing or insufficient permissions"))throw Error("Insufficient permissions to update this campaign. Please ensure you're logged in and own this campaign.");else throw Error("Failed to update campaign: ".concat(t.message))}}static async deleteCampaign(e){try{console.log("Attempting to delete campaign:",e);let t=await (0,a.x7)((0,a.H9)(i.db,"campaigns",e));if(!t.exists())throw Error("Campaign not found");let r=t.data();console.log("Campaign data:",r),await (0,a.kd)((0,a.H9)(i.db,"campaigns",e)),console.log("Campaign deleted successfully")}catch(t){if(console.error("Delete campaign error details:",{error:t.message,code:t.code,campaignId:e}),"permission-denied"===t.code)throw Error("You don't have permission to delete this campaign. Please check if you're the campaign owner and logged in.");if("not-found"===t.code)throw Error("Campaign not found or has already been deleted.");if(t.message.includes("Missing or insufficient permissions"))throw Error("Insufficient permissions to delete this campaign. Please ensure you're logged in and own this campaign.");else throw Error("Failed to delete campaign: ".concat(t.message))}}static async recordDonationOnly(e){try{console.log("Recording donation only:",e);let t=await (0,a.gS)((0,a.collection)(i.db,"donations"),{...e,createdAt:(0,a.O5)(),status:"recorded",campaignUpdated:!1});return console.log("Donation recorded with ID:",t.id),!0}catch(t){return console.error("Failed to record donation:",t),s({...e,recordType:"donation_only"}),!1}}static async updateCampaignStats(e,t){try{console.log("Updating campaign stats:",e,t);let r=(0,a.H9)(i.db,"campaigns",e);if(!(await (0,a.x7)(r)).exists())return console.error("Campaign not found:",e),!1;return await (0,a.mZ)(r,{raised:(0,a.GV)(t),donors:(0,a.GV)(1),updatedAt:(0,a.O5)()}),console.log("Campaign stats updated successfully"),!0}catch(r){return console.error("Failed to update campaign stats:",r),s({campaignId:e,amount:t,recordType:"campaign_stats"}),!1}}static async recordDonation(e){try{if(console.log("Recording donation:",e),await this.recordDonationOnly(e))try{await this.updateCampaignStats(e.campaignId,e.amount)}catch(e){console.error("Campaign stats update failed, but donation was recorded:",e)}}catch(t){console.error("Record donation error:",t),s(e)}}static async getCampaignsByCreator(e){try{let t=(0,a.query)((0,a.collection)(i.db,"campaigns"),(0,a.where)("creatorId","==",e),(0,a.orderBy)("createdAt","desc")),r=await (0,a.getDocs)(t);if(r.empty)return o.filter(t=>t.creatorId===e);return r.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:(0,n.xi)(t.createdAt),updatedAt:(0,n.xi)(t.updatedAt),endDate:(0,n.xi)(t.endDate)}})}catch(t){return console.error("Get campaigns by creator error:",t),o.filter(t=>t.creatorId===e)}}static async getCampaignsSimple(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{let t=(0,a.query)((0,a.collection)(i.db,"campaigns"),(0,a.AB)(e)),r=await (0,a.getDocs)(t);if(r.empty)return o;return r.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:(0,n.xi)(t.createdAt),updatedAt:(0,n.xi)(t.updatedAt),endDate:(0,n.xi)(t.endDate)}})}catch(e){return console.error("Get campaigns simple error:",e),o}}}},97168:(e,t,r)=>{r.d(t,{$:()=>c,r:()=>d});var a=r(95155),i=r(12115),n=r(99708),o=r(74466),s=r(53999);let d=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,t)=>{let{className:r,variant:i,size:o,asChild:c=!1,...l}=e,u=c?n.DX:"button";return(0,a.jsx)(u,{className:(0,s.cn)(d({variant:i,size:o,className:r})),ref:t,...l})});c.displayName="Button"},98915:(e,t,r)=>{let a,i,n,o;r.d(t,{IG:()=>o,db:()=>n,j2:()=>i});var s=r(23915),d=r(16203),c=r(35317),l=r(90858),u=r(49509);let g={apiKey:u.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:u.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:u.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:u.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:u.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:u.env.NEXT_PUBLIC_FIREBASE_APP_ID};try{a=(0,s.Wp)(g),i=(0,d.xI)(a),n=(0,c.aU)(a),o=(0,l.c7)(a),console.log("Firebase initialized successfully on client")}catch(e){console.error("Failed to initialize Firebase:",e)}}}]);