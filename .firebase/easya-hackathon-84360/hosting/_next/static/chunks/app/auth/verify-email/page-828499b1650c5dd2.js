(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3270],{17379:(e,r,a)=>{Promise.resolve().then(a.bind(a,81540))},28883:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(19946).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},35169:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(19946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},40646:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(19946).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},50395:(e,r,a)=>{"use strict";a.d(r,{A:()=>c,AuthProvider:()=>o});var t=a(95155),s=a(12115),i=a(16203),l=a(35317),n=a(98915);let d=(0,s.createContext)(void 0);function o(e){let{children:r}=e,[a,o]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0),[h,m]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!n.j2){console.error("Firebase auth is not initialized"),u(!1);return}let e=(0,i.hg)(n.j2,async e=>{try{if(e){if(!n.db){console.error("Firebase db is not initialized"),u(!1);return}let r=await (0,l.x7)((0,l.H9)(n.db,"users",e.uid));if(r.exists()){let a=r.data();o({uid:e.uid,email:e.email,displayName:e.displayName,isVerified:e.emailVerified,role:a.role||"user",createdAt:a.createdAt?new Date(a.createdAt.toDate()):null,updatedAt:a.updatedAt?new Date(a.updatedAt.toDate()):null,walletAddress:a.walletAddress,campaignsCreated:a.campaignsCreated,donationsCount:a.donationsCount,totalDonated:a.totalDonated,totalRaised:a.totalRaised})}else{let r={uid:e.uid,email:e.email,displayName:e.displayName,isVerified:e.emailVerified,role:"user",createdAt:new Date,updatedAt:new Date};await (0,l.BN)((0,l.H9)(n.db,"users",e.uid),r),o(r)}}else o(null)}catch(e){console.error("Error in auth state change:",e),m("Failed to load user data"),o(null)}finally{u(!1)}});return()=>e()},[]);let x=async(e,r,a)=>{if(!n.j2||!n.db)throw Error("Firebase is not initialized");try{u(!0),m(null);let t=await (0,i.eJ)(n.j2,e,r);await (0,i.r7)(t.user,{displayName:a}),await (0,l.BN)((0,l.H9)(n.db,"users",t.user.uid),{uid:t.user.uid,email:e,displayName:a,isVerified:!1,role:"user",createdAt:new Date,updatedAt:new Date}),await (0,i.gA)(t.user)}catch(e){throw console.error("Sign up error:",e),m(e.message),e}finally{u(!1)}},f=async(e,r)=>{if(!n.j2)throw Error("Firebase auth is not initialized");try{u(!0),m(null),await (0,i.x9)(n.j2,e,r)}catch(e){throw console.error("Sign in error:",e),m(e.message),e}finally{u(!1)}},b=async()=>{if(!n.j2)throw Error("Firebase auth is not initialized");try{u(!0),m(null),await (0,i.CI)(n.j2)}catch(e){throw console.error("Sign out error:",e),m(e.message),e}finally{u(!1)}},w=async()=>{if(!n.j2||!n.j2.currentUser)throw Error("No user is currently signed in");try{await (0,i.gA)(n.j2.currentUser)}catch(e){throw console.error("Email verification error:",e),e}},g=async e=>{if(!n.j2)throw Error("Firebase auth is not initialized");try{await (0,i.J1)(n.j2,e)}catch(e){throw console.error("Password reset error:",e),e}},p=async e=>{if(!n.j2||!n.j2.currentUser||!n.db)throw Error("Firebase is not initialized or no user is signed in");try{await (0,i.r7)(n.j2.currentUser,{displayName:e}),await (0,l.mZ)((0,l.H9)(n.db,"users",n.j2.currentUser.uid),{displayName:e,updatedAt:new Date}),a&&o({...a,displayName:e})}catch(e){throw console.error("Profile update error:",e),e}};return(0,t.jsx)(d.Provider,{value:{user:a,loading:c,error:h,signUp:x,signIn:f,signOut:b,sendEmailVerification:w,sendPasswordReset:g,updateUserProfile:p},children:r})}function c(){let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},53999:(e,r,a)=>{"use strict";a.d(r,{cn:()=>i});var t=a(52596),s=a(39688);function i(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,s.QP)((0,t.$)(r))}},81540:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>v});var t=a(95155),s=a(12115),i=a(35695),l=a(6874),n=a.n(l),d=a(19946);let o=(0,d.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var c=a(40646),u=a(28883);let h=(0,d.A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var m=a(35169),x=a(97168),f=a(88482),b=a(98915),w=a(16203),g=a(35317);class p{static async signUp(e,r,a){if(!b.j2||!b.db)throw Error("Firebase is not initialized");try{let t=(await (0,w.eJ)(b.j2,e,r)).user;await (0,w.r7)(t,{displayName:a});let s={uid:t.uid,email:t.email,displayName:a,isVerified:!1,role:"user",createdAt:new Date,updatedAt:new Date};return await (0,g.BN)((0,g.H9)(b.db,"users",t.uid),s),await (0,w.gA)(t),s}catch(e){throw console.error("Sign up error:",e),e}}static async signIn(e,r){if(!b.j2||!b.db)throw Error("Firebase is not initialized");try{let a=(await (0,w.x9)(b.j2,e,r)).user,t=await (0,g.x7)((0,g.H9)(b.db,"users",a.uid));if(!t.exists())throw Error("User document not found");return{...t.data(),isVerified:a.emailVerified}}catch(e){throw console.error("Sign in error:",e),e}}static async signOut(){if(!b.j2)throw Error("Firebase auth is not initialized");try{await (0,w.CI)(b.j2)}catch(e){throw console.error("Sign out error:",e),e}}static async getUserData(e){if(!b.db)throw Error("Firebase db is not initialized");try{let r=await (0,g.x7)((0,g.H9)(b.db,"users",e));if(!r.exists())throw Error("User document not found");return r.data()}catch(e){throw console.error("Get user data error:",e),e}}static async updateWalletAddress(e,r){if(!b.db)throw Error("Firebase db is not initialized");try{await (0,g.mZ)((0,g.H9)(b.db,"users",e),{walletAddress:r,updatedAt:new Date})}catch(e){throw console.error("Update wallet address error:",e),e}}static async resendVerificationEmail(){if(!b.j2||!b.j2.currentUser)throw Error("No user is currently signed in");try{await (0,w.gA)(b.j2.currentUser)}catch(e){throw console.error("Resend verification email error:",e),e}}static async checkEmailVerificationStatus(){if(!b.j2||!b.j2.currentUser)throw Error("No user is currently signed in");try{return await b.j2.currentUser.reload(),b.j2.currentUser.emailVerified}catch(e){throw console.error("Check email verification status error:",e),e}}}var y=a(50395);function v(){let e=(0,i.useRouter)(),r=(0,i.useSearchParams)(),{user:a,checkEmailVerification:l}=(0,y.A)(),[d,b]=(0,s.useState)("loading"),[w,g]=(0,s.useState)(""),[v,j]=(0,s.useState)(!1),[N,k]=(0,s.useState)(!1),A=r.get("oobCode"),E=r.get("mode"),C=r.get("continueUrl");(0,s.useEffect)(()=>{(async()=>{if(null==a?void 0:a.isVerified){b("already-verified");return}if(A&&"verifyEmail"===E)try{await p.verifyEmailWithCode(A),b("success"),setTimeout(()=>{e.push(C||"/dashboard")},3e3)}catch(r){console.error("Email verification error:",r),b("error");let e="Failed to verify email. Please try again.";r.message?e=r.message:"auth/invalid-action-code"===r.code?e="This verification link is invalid or has expired. Please request a new one.":"auth/expired-action-code"===r.code?e="This verification link has expired. Please request a new verification email.":"auth/user-disabled"===r.code&&(e="This account has been disabled. Please contact support."),g(e)}else b("manual-check")})()},[A,E,C,e,a]);let F=async()=>{j(!0);try{await p.resendVerificationEmail(),g("A new verification email has been sent to your inbox. Please check your email and spam folder.")}catch(e){console.error("Resend verification error:",e),g(e.message||"Failed to resend verification email. Please try again later.")}finally{j(!1)}},_=async()=>{k(!0);try{await l()?(b("success"),setTimeout(()=>{e.push("/dashboard")},2e3)):g("Email is not yet verified. Please check your email and click the verification link.")}catch(e){console.error("Check verification status error:",e),g("Failed to check verification status. Please try again.")}finally{k(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url('/images/charity-background.jpg')",backgroundSize:"cover",backgroundPosition:"center"},children:(0,t.jsx)("div",{className:"absolute inset-0 bg-white/70 backdrop-blur-sm"})}),(0,t.jsxs)("div",{className:"relative z-10 min-h-screen flex flex-col",children:[(0,t.jsx)("header",{className:"bg-white/90 backdrop-blur-md border-b border-slate-200 py-4 px-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,t.jsxs)(n(),{href:"/dashboard",className:"flex items-center gap-2",children:[(0,t.jsx)("img",{src:"/images/wefund-icon.png",alt:"WeFund Logo",className:"h-8 w-auto"}),(0,t.jsx)("span",{className:"text-xl font-bold text-slate-800",children:"WeFund"})]}),(0,t.jsxs)(n(),{href:"/dashboard",className:"text-slate-600 hover:text-slate-800 flex items-center gap-1",children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back to Home"})]})]})}),(0,t.jsx)("main",{className:"flex-1 flex items-center justify-center p-6",children:(()=>{switch(d){case"loading":return(0,t.jsx)(f.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-md shadow-xl border-slate-200",children:(0,t.jsxs)(f.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 p-3 bg-blue-100 rounded-full w-fit",children:(0,t.jsx)(o,{className:"h-8 w-8 text-blue-600 animate-spin"})}),(0,t.jsx)(f.ZB,{className:"text-xl",children:"Verifying Email"}),(0,t.jsx)(f.BT,{children:"Please wait while we verify your email address..."})]})});case"success":return(0,t.jsxs)(f.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-md shadow-xl border-slate-200",children:[(0,t.jsxs)(f.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 p-3 bg-green-100 rounded-full w-fit",children:(0,t.jsx)(c.A,{className:"h-8 w-8 text-green-600"})}),(0,t.jsx)(f.ZB,{className:"text-xl text-green-800",children:"Email Verified!"}),(0,t.jsx)(f.BT,{children:"Your email address has been successfully verified. You now have full access to all features."})]}),(0,t.jsxs)(f.Wu,{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Redirecting you to the dashboard in a few seconds..."}),(0,t.jsx)(x.$,{onClick:()=>e.push(C||"/dashboard"),className:"w-full",style:{backgroundColor:"#3CAEA3"},children:"Continue to Dashboard"})]})]});case"already-verified":return(0,t.jsxs)(f.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-md shadow-xl border-slate-200",children:[(0,t.jsxs)(f.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 p-3 bg-green-100 rounded-full w-fit",children:(0,t.jsx)(c.A,{className:"h-8 w-8 text-green-600"})}),(0,t.jsx)(f.ZB,{className:"text-xl text-green-800",children:"Already Verified"}),(0,t.jsx)(f.BT,{children:"Your email address is already verified. You have full access to all features."})]}),(0,t.jsx)(f.Wu,{className:"text-center",children:(0,t.jsx)(x.$,{onClick:()=>e.push("/dashboard"),className:"w-full",style:{backgroundColor:"#3CAEA3"},children:"Go to Dashboard"})})]});case"manual-check":return(0,t.jsxs)(f.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-md shadow-xl border-slate-200",children:[(0,t.jsxs)(f.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 p-3 bg-blue-100 rounded-full w-fit",children:(0,t.jsx)(u.A,{className:"h-8 w-8 text-blue-600"})}),(0,t.jsx)(f.ZB,{className:"text-xl",children:"Check Your Email"}),(0,t.jsx)(f.BT,{children:"We've sent a verification email to your address. Please click the link in the email to verify your account."})]}),(0,t.jsxs)(f.Wu,{className:"space-y-4",children:[(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"After clicking the verification link in your email, you can check your verification status here."})}),w&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,t.jsx)("p",{className:"text-red-800 text-sm",children:w})}),(0,t.jsx)(x.$,{onClick:_,disabled:N,className:"w-full",style:{backgroundColor:"#3CAEA3"},children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{className:"h-4 w-4 mr-2 animate-spin"}),"Checking..."]}):"I've Verified My Email"}),a&&!a.isVerified&&(0,t.jsx)(x.$,{onClick:F,disabled:v,className:"w-full",variant:"outline",children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Resend Verification Email"]})}),(0,t.jsx)(x.$,{onClick:()=>e.push("/dashboard"),variant:"outline",className:"w-full",children:"Continue Without Verification"})]})]});case"error":return(0,t.jsxs)(f.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-md shadow-xl border-slate-200",children:[(0,t.jsxs)(f.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 p-3 bg-red-100 rounded-full w-fit",children:(0,t.jsx)(h,{className:"h-8 w-8 text-red-600"})}),(0,t.jsx)(f.ZB,{className:"text-xl text-red-800",children:"Verification Failed"}),(0,t.jsx)(f.BT,{className:"text-red-600",children:w})]}),(0,t.jsxs)(f.Wu,{className:"space-y-4",children:[a&&!a.isVerified&&(0,t.jsx)(x.$,{onClick:F,disabled:v,className:"w-full",variant:"outline",children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Resend Verification Email"]})}),(0,t.jsx)(x.$,{onClick:()=>e.push("/auth"),variant:"outline",className:"w-full",children:"Back to Sign In"}),(0,t.jsx)(x.$,{onClick:()=>e.push("/dashboard"),variant:"outline",className:"w-full",children:"Continue to Dashboard"})]})]});default:return null}})()}),(0,t.jsx)("footer",{className:"bg-white/90 backdrop-blur-md border-t border-slate-200 py-4 px-6",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto text-center text-sm text-slate-500",children:(0,t.jsx)("p",{children:"\xa9 2025 WeFund. All rights reserved."})})})]})]})}},88482:(e,r,a)=>{"use strict";a.d(r,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>n,wL:()=>u});var t=a(95155),s=a(12115),i=a(53999);let l=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let n=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});n.displayName="CardHeader";let d=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});d.displayName="CardTitle";let o=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},97168:(e,r,a)=>{"use strict";a.d(r,{$:()=>o,r:()=>d});var t=a(95155),s=a(12115),i=a(99708),l=a(74466),n=a(53999);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,r)=>{let{className:a,variant:s,size:l,asChild:o=!1,...c}=e,u=o?i.DX:"button";return(0,t.jsx)(u,{className:(0,n.cn)(d({variant:s,size:l,className:a})),ref:r,...c})});o.displayName="Button"},98915:(e,r,a)=>{"use strict";let t,s,i,l;a.d(r,{IG:()=>l,db:()=>i,j2:()=>s});var n=a(23915),d=a(16203),o=a(35317),c=a(90858),u=a(49509);let h={apiKey:u.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:u.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:u.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:u.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:u.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:u.env.NEXT_PUBLIC_FIREBASE_APP_ID};try{t=(0,n.Wp)(h),s=(0,d.xI)(t),i=(0,o.aU)(t),l=(0,c.c7)(t),console.log("Firebase initialized successfully on client")}catch(e){console.error("Failed to initialize Firebase:",e)}}},e=>{var r=r=>e(e.s=r);e.O(0,[2992,5965,3817,6874,3183,8441,1684,7358],()=>r(17379)),_N_E=e.O()}]);